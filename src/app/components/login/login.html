<div class="container-fluid vh-100 landing position-relative">
  <!-- โ ูุจู ุชุณุฌูู ุงูุฏุฎูู -->
  <div *ngIf="!isLoggedIn" class="row h-100 full-bg">
    <div class="col-12 col-md-6 p-0 d-none d-md-block"></div>

    <div
      class="col-12 col-md-6 d-flex align-items-center justify-content-center"
    >
      <div
        class="left-box text-center p-4 w-100 login-box"
        style="max-width: 400px"
      >
        <img
          src="/photos/logo.png"
          alt="Logo"
          class="img-fluid m-0 w-50 w-md-75 w-lg-100"
        />

        <!-- <h2 class="mb-1">ุชุณุฌูู ุฏุฎูู</h2> -->

        <form [formGroup]="loginForm" (ngSubmit)="onSubmit()">
          <div class="mb-3 text-end">
            <label class="form-label">ุงุณู ุงููุณุชุฎุฏู</label>
            <input
              type="text"
              formControlName="username"
              class="form-control"
              placeholder="ุงุณู ุงููุณุชุฎุฏู"
              dir="rtl"
            />
            <div
              *ngIf="
                loginForm.get('username')?.touched &&
                loginForm.get('username')?.invalid
              "
              class="text-danger small mt-1"
            >
              ุงุณู ุงููุณุชุฎุฏู ูุทููุจ
            </div>
          </div>

          <div class="mb-3 text-end position-relative">
            <label class="form-label">ูููุฉ ุงููุฑูุฑ</label>
            <input
              [type]="showPassword ? 'text' : 'password'"
              formControlName="password"
              class="form-control ps-5 text-end"
              placeholder="ูููุฉ ุงููุฑูุฑ"
              dir="rtl"
            />
            <button
              type="button"
              class="btn btn-link p-0 position-absolute top-50 start-0 translate-middle-x ms-3 mt-1"
              (click)="togglePassword()"
              tabindex="-1"
            >
              <i
                class="bi"
                [ngClass]="showPassword ? 'bi-eye-slash' : 'bi-eye'"
              ></i>
            </button>
            <div
              *ngIf="
                loginForm.get('password')?.touched &&
                loginForm.get('password')?.invalid
              "
              class="text-danger small mt-1"
            >
              ูููุฉ ุงููุฑูุฑ ูุทููุจุฉ
            </div>
          </div>

          <div class="d-grid">
            <button
              class="btn btn-warning btn-lg m-0 w-25 mx-auto py-0"
              type="submit"
            >
              ุฏุฎูู
            </button>
          </div>
        </form>
        <div class="mt-auto text-center pt-3 small opacity-75">
          ุฌููุน ุงูุญููู ูุญููุธุฉ ููุคุณุณุฉ ุงููุงุจุชู ยฉ 2025
        </div>
      </div>
    </div>
  </div>

  <!-- โ ุจุนุฏ ุชุณุฌูู ุงูุฏุฎูู -->
  <div *ngIf="isLoggedIn" class="row h-100">
    <!-- ๐ฆ ุงูุดูุงู -->
    <div
      class="col"
      [class.col-md-9]="isSidebarExpanded"
      [class.col-md-11]="!isSidebarExpanded"
      class="d-flex align-items-center justify-content-center bg-white transition-all"
    >
      <div class="content text-center p-0 w-100 mb-auto">
        <router-outlet></router-outlet>
      </div>
    </div>

    <!-- ๐ง ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ -->
    <div
      class="d-flex flex-column bg-side text-white p-3 justify-content-start align-content-start transition-all"
      [class.col-md-3]="isSidebarExpanded"
      [class.col-md-1]="!isSidebarExpanded"
      style="overflow: hidden"
    >
      <!-- ุฒุฑ ุงูุทู / ุงููุชุญ -->
      <button
        class="toggle-btn btn btn-outline-light rounded-circle position-fixed transition-all"
        (click)="toggleSidebar()"
        [ngStyle]="{
          right: isSidebarExpanded ? '24%' : '7%',
          top: '75px',
          zIndex: 1050
        }"
      >
        <i
          class="bi text-center"
          [ngClass]="isSidebarExpanded ? 'bi-chevron-right' : 'bi-chevron-left'"
        ></i>
      </button>

      <!-- โณ๏ธ ุงููุญุชูู ููุง ุงููุงุฆูุฉ ููุชูุญุฉ -->
      <div *ngIf="isSidebarExpanded" class="sidebar-content transition-all">
        <h4 class="text-center mb-2 p-1 opacity-75 bg-dark rounded-pill">
          ุงููุงุจุชู ููุณูุงุฑุงุช
        </h4>

        <!-- ๐งโโ๏ธ ุจูุงูุงุช ุงููุณุชุฎุฏู -->
    <div class="user-box d-flex justify-content-between align-items-center my-2 py-2 w-100 mx-auto" dir="rtl">
  <!-- ุงูุตูุฑุฉ ุนูู ุงููููู -->
  <div class="text-center me-2">
    <img
      *ngIf="userImg; else defaultIcon"
      [src]="userImg"
      alt="User Image"
      class="user-img rounded-pill"
      style="width: 100px; height: 100px; object-fit: cover"
    />
    <ng-template #defaultIcon>
      <i class="bi bi-person-circle fs-1 text-secondary"></i>
    </ng-template>
  </div>

  <!-- ุงูุงุณู ูุงูุฑูู ูู ุงูููุชุตู -->
  <div class="text-center flex-grow-1">
    <h5 class="user-name mb-1">{{ userFullName }}</h5>
    <small class="user-title text-white bg-dark rounded-pill fw-bold px-2 py-1">
      {{ rankProfile }}
    </small>
  </div>

  <!-- ุงูุฃุฒุฑุงุฑ ุนูู ุงููุณุงุฑ -->
  <div class="d-flex flex-column align-items-start ms-2">
    <button
      class="btn btn-outline-secondary btn-sm position-relative mb-1 rounded-circle"
      [routerLink]="['/notifications']"
    >
      <i class="bi bi-bell"></i>
      <span class="position-absolute top-0 start-100 translate-middle badge bg-danger">
        {{ unreadCount }}
      </span>
    </button>

    <button class="btn btn-danger btn-sm rounded-circle" (click)="logout()">
      <i class="bi bi-box-arrow-right"></i>
    </button>
  </div>
</div>


        <!-- ๐ฆ ุงูุฃุฒุฑุงุฑ -->
        <div
          class="buttons-grid d-flex flex-wrap justify-content-start transition-all"
          [ngClass]="isSidebarExpanded ? 'expanded' : 'collapsed'"
          dir="rtl"
        >
          <div
            *ngFor="let b of buttons"
            (click)="router.navigate([b.route])"
            class="button-item d-flex justify-content-center align-items-center transition-all"
          >
            <button
              class="btn d-flex flex-column align-items-center justify-content-center text-nowrap transition-all"
              [routerLink]="b.route"
              routerLinkActive="btn-light text-dark"
              [routerLinkActiveOptions]="{ exact: true }"
            >
              <i
                class="{{ b.icon }} mb-1"
                [ngClass]="isSidebarExpanded ? 'fs-5' : 'fs-6'"
              ></i>
              <span *ngIf="isSidebarExpanded">{{ b.label }}</span>
            </button>
          </div>
        </div>

        <div class="footer-text text-center small opacity-75 bg-dark rounded">
          ุฌููุน ุงูุญููู ูุญููุธุฉ ููุคุณุณุฉ ุงููุงุจุชู ยฉ 2025
        </div>
      </div>

      <!-- โณ๏ธ ุงููุญุชูู ููุง ุงููุงุฆูุฉ ูุทููุฉ -->
      <div
        *ngIf="!isSidebarExpanded"
        class="collapsed-menu d-flex flex-column align-items-center mt-3 gap-3"
      >
        <!-- ๐ค ุตูุฑุฉ ุงููุณุชุฎุฏู -->
        <div class="text-center">
          <img
            *ngIf="userImg; else defaultIconSmall"
            [src]="userImg"
            alt="User Image"
            class="rounded-circle border border-light"
            style="width: 60px; height: 60px; object-fit: cover"
          />
          <ng-template #defaultIconSmall>
            <i class="bi bi-person-circle fs-2 text-secondary"></i>
          </ng-template>
        </div>

        <!-- ุงูุฃุฒุฑุงุฑ ุชุญุช ุงูุตูุฑุฉ -->
        <div *ngFor="let b of buttons">
          <button
            class="btn btn-outline-light rounded-circle p-2"
            [routerLink]="b.route"
            routerLinkActive="btn-light text-dark"
            [routerLinkActiveOptions]="{ exact: true }"
            [title]="b.label"
            style="width: 45px; height: 45px"
          >
            <i class="{{ b.icon }}"></i>
          </button>
        </div>

        <!-- ุฃุฒุฑุงุฑ ุงูุฅุดุนุงุฑุงุช ูุงูุฎุฑูุฌ -->
        <div class="mt-3 d-flex flex-column align-items-center gap-2">
          <button
            class="btn btn-outline-secondary btn-sm rounded-circle position-relative"
            [routerLink]="['/notifications']"
            style="width: 40px; height: 40px"
          >
            <i class="bi bi-bell"></i>
            <span
              class="position-absolute top-0 start-100 translate-middle badge bg-danger"
              style="font-size: 0.6rem"
            >
              {{ unreadCount }}
            </span>
          </button>

          <button
            class="btn btn-danger btn-sm rounded-circle"
            (click)="logout()"
            style="width: 40px; height: 40px"
          >
            <i class="bi bi-box-arrow-right"></i>
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
