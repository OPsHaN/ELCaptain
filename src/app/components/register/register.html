<div class="container py-1">
  <div class="row justify-content-center">
    <div class="col-12 col-lg-12 col-md-12 col-sm-12">
      <div class="card p-2 rounded-4">
        <div class="d-flex justify-content-between align-items-center mb-3">
          <div class="justify-content-end">
            <h3 class="text-center mb-2 fw-bold text-dark">
              {{ isEditMode ? "โ๏ธ ุชุนุฏูู ููุธู" : "๐ ุชุณุฌูู ููุธู" }}
            </h3>
          </div>
          <div class="justify-content-start">
            <span
              class="position-realtive top-0 end-0 bg-danger text-white rounded-circle px-2 py-1"
              style="cursor: pointer"
              (click)="closeForm.emit()"
            >
              โ
            </span>
          </div>
        </div>
        <form
          [formGroup]="registerForm"
          (ngSubmit)="onSubmit()"
          novalidate
          dir="rtl"
        >
          <div class="col-md-4 text-center my-2" style="width: 100px">
            <!-- <label class="form-label">๐ธ ุตูุฑุฉ ุงูููุธู</label> -->

            <div class="avatar-upload">
              <img
                [src]="profilePreview || defaultAvatar"
                alt="ุตูุฑุฉ ุงูููุธู"
                class="avatar-img"
              />
              <label for="avatarInput" class="edit-icon">โ๏ธ</label>
              <input
                type="file"
                id="avatarInput"
                accept="image/*"
                (change)="onFileSelected($event)"
              />
            </div>
          </div>

          <div class="row g-3 text-end">
            <!-- ุงูุงุณู ุงูุฃูู -->
            <div class="col-md-4">
              <label class="form-label">ุงูุงุณู ุงูุฃูู</label>
              <input
                type="text"
                class="form-control custom-input"
                formControlName="FirstName"
              />
              <small
                class="text-danger"
                *ngIf="
                  registerForm.get('FirstName')?.touched &&
                  registerForm.get('FirstName')?.invalid
                "
              >
                ูุทููุจ
              </small>
            </div>

            <!-- ุงูุงุณู ุงูุซุงูู -->
            <div class="col-md-4">
              <label class="form-label">ุงูุงุณู ุงูุซุงูู</label>
              <input
                type="text"
                class="form-control custom-input"
                formControlName="SecondName"
              />
            </div>

            <div class="col-md-4">
              <label class="form-label">ุงูุฅุณู ุงูุซุงูุช</label>
              <input
                type="text"
                class="form-control custom-input"
                formControlName="ThirdName"
              />
              <small
                class="text-danger"
                *ngIf="
                  registerForm.get('ThirdName')?.touched &&
                  registerForm.get('ThirdName')?.invalid
                "
              >
                ูุทููุจ
              </small>
            </div>

            <!-- ุงูุชุตููู -->
            <div class="col-md-4">
              <label class="form-label">ุงูุฑุชุจุฉ</label>
              <mat-form-field appearance="outline" class="w-100 custom-outline">
                <mat-select formControlName="UserType">
                  <mat-option *ngFor="let rank of ranks" [value]="rank.code">
                    {{ rank.name }}
                  </mat-option>
                </mat-select>
              </mat-form-field>
              <small
                class="text-danger"
                *ngIf="
                  registerForm.get('UserType')?.touched &&
                  registerForm.get('UserType')?.invalid
                "
                >ูุทููุจ</small
              >
            </div>

            <!-- ุงูุฑูู ุงููููู -->
            <div class="col-md-4">
              <label class="form-label">ุงูุฑูู ุงููููู</label>
              <input
                type="text"
                class="form-control custom-input"
                formControlName="NationalId"
                maxlength="14"
                oninput="this.value = this.value.replace(/[^0-9]/g, '')"
              />
              <small
                class="text-danger"
                *ngIf="
                  registerForm.get('NationalId')?.touched &&
                  registerForm.get('NationalId')?.invalid
                "
              >
                ูุฌุจ ุฃู ูููู 14 ุฑูููุง ุจุงูุถุจุท
              </small>
            </div>

            <!-- ุงุณู ุงููุณุชุฎุฏู -->
            <div class="col-md-4">
              <label class="form-label">ุงุณู ุงููุณุชุฎุฏู</label>
              <input
                type="text"
                class="form-control custom-input"
                formControlName="UserName"
              />
              <small
                class="text-danger"
                *ngIf="
                  registerForm.get('UserName')?.touched &&
                  registerForm.get('UserName')?.invalid
                "
              >
                ูุทููุจ
              </small>
            </div>

            <!-- ูููุฉ ุงููุฑูุฑ -->
            <div class="col-md-4">
              <label class="form-label">
                ูููุฉ ุงููุฑูุฑ
                <span *ngIf="!isEditMode" class="text-danger">*</span>
              </label>

              <input
                type="text"
                class="form-control custom-input"
                formControlName="Password"
                [placeholder]="
                  isEditMode
                    ? 'ุงุชุฑููุง ูุงุฑุบุฉ ุฅุฐุง ูุง ุชุฑูุฏ ุชุบููุฑูุง'
                    : 'ุฃุฏุฎู ูููุฉ ุงููุฑูุฑ (ุงูุญุฏ ุงูุฃุฏูู 6 ุฃุญุฑู)'
                "
              />

              <small
                class="text-danger"
                *ngIf="
                  registerForm.get('Password')?.touched &&
                  registerForm.get('Password')?.hasError('minlength')
                "
              >
                ุงูุญุฏ ุงูุฃุฏูู 6 ุฃุญุฑู
              </small>

              <small
                class="text-danger"
                *ngIf="
                  !isEditMode &&
                  registerForm.get('Password')?.touched &&
                  registerForm.get('Password')?.hasError('required')
                "
              >
                ูููุฉ ุงููุฑูุฑ ูุทููุจุฉ
              </small>
            </div>

            <!-- ุงูุจุฑูุฏ -->
            <div class="col-md-4">
              <label class="form-label">ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</label>
              <div class="input-group">
                <input
                  type="email"
                  class="form-control border-start-0 custom-input"
                  formControlName="Email"
                  placeholder="example@domain.com"
                />
              </div>
            </div>

            <!-- ุฑูู ุงููุงุชู -->
            <div class="col-md-4">
              <label class="form-label">ุฑูู ุงููุงุชู</label>
              <input
                type="text"
                class="form-control custom-input"
                formControlName="Phone"
                maxlength="11"
                oninput="this.value = this.value.replace(/[^0-9]/g, '')"
              />
              <small
                class="text-danger"
                *ngIf="
                  registerForm.get('Phone')?.touched &&
                  registerForm.get('Phone')?.invalid
                "
              >
                ูุฌุจ ุฃู ูููู 11 ุฑูููุง ุจุงูุถุจุท
              </small>
            </div>

            <!-- ุฑูู ูุงุชู ุฅุถุงูู -->
            <div class="col-md-4">
              <label class="form-label">ุฑูู ูุงุชู ุฅุถุงูู</label>
              <input
                type="text"
                class="form-control custom-input"
                formControlName="Phone2"
              />
            </div>

            <!-- ุงููุฑุน -->
            <div class="col-md-4">
              <label class="form-label">ุงููุฑุน</label>
              <mat-form-field appearance="outline" class="w-100 custom-outline">
                <mat-select formControlName="BranchId">
                  <mat-option
                    *ngFor="let branch of branches"
                    [value]="branch.Id"
                  >
                    {{ branch.BranchName }}
                  </mat-option>
                </mat-select>
              </mat-form-field>
              <small
                class="text-danger"
                *ngIf="
                  registerForm.get('BranchId')?.touched &&
                  registerForm.get('BranchId')?.invalid
                "
              >
                ูุทููุจ
              </small>
            </div>

            <!-- ุงูุชุตููู -->
            <div class="col-md-4">
              <label class="form-label">ุชุตููู ุงูููุธู</label>
              <mat-form-field appearance="outline" class="w-100 custom-outline">
                <mat-select formControlName="Classification">
                  <mat-option
                    *ngFor="let class of classification"
                    [value]="class.code"
                  >
                    {{ class.name }}
                  </mat-option>
                </mat-select>
              </mat-form-field>
              <small
                class="text-danger"
                *ngIf="
                  registerForm.get('Classification')?.touched &&
                  registerForm.get('Classification')?.invalid
                "
              >
                ูุทููุจ
              </small>
            </div>

            <!-- โ ุงูุฏููุฉ ุฐุงุช ุงูุฎุจุฑุฉ -->
            <div class="col-md-4">
              <label class="form-label">ุฎุจุฑุฉ ุงูููุธู ูู</label>
              <mat-form-field appearance="outline" class="w-100 custom-outline">
                <mat-select formControlName="ExperiencedInCountryIds" multiple>
                  <mat-option *ngFor="let c of countries" [value]="c.id">
                    <div class="d-flex align-items-center gap-2">
                      <img
                        [src]="c.img"
                        alt="{{ c.name }}"
                        width="30"
                        height="20"
                        style="object-fit: cover; border-radius: 4px"
                      />
                      <span>{{ c.name }}</span>
                    </div>
                  </mat-option>
                </mat-select>
              </mat-form-field>

              <small
                class="text-danger"
                *ngIf="
                  registerForm.get('ExperiencedInCountryIds')?.touched &&
                  registerForm.get('ExperiencedInCountryIds')?.invalid
                "
              >
                ูุทููุจ ุงุฎุชูุงุฑ ุงูุฏููุฉ
              </small>
            </div>

            <!-- โ ูู ูุฏูู ุฎุจุฑุฉ ููุฑุจุงุก -->
            <div class="col-md-4">
              <div class="form-check mt-4">
                <input
                  type="checkbox"
                  id="elec"
                  class="form-check-input"
                  formControlName="ExperiencedInElec"
                />
                <label for="elec" class="form-check-label"
                  >ุฎุจุฑุฉ ูู ุงูููุฑุจุงุก</label
                >
              </div>
            </div>

            <!-- โ ูู ูุฏูู ุฎุจุฑุฉ ูุงูุจุฑุฏ -->
            <div class="col-md-4">
              <div class="form-check mt-4">
                <input
                  type="checkbox"
                  id="hybrd"
                  class="form-check-input"
                  formControlName="ExperiencedInHybrd"
                />
                <label for="hybrd" class="form-check-label"
                  >ุฎุจุฑุฉ ูู ุงููุงูุจุฑุฏ</label
                >
              </div>
            </div>

            <!-- ูู - ุฅูู -->
            <div class="col-md-4">
              <label class="form-label">ูู</label>
              <input
                type="time"
                class="form-control custom-input"
                formControlName="FromTime"
              />
              <small
                class="text-danger"
                *ngIf="
                  registerForm.get('FromTime')?.touched &&
                  registerForm.get('FromTime')?.invalid
                "
              >
                ูุทููุจ
              </small>
            </div>

            <div class="col-md-4">
              <label class="form-label">ุฅูู</label>
              <input
                type="time"
                class="form-control custom-input"
                formControlName="ToTime"
              />
              <small
                class="text-danger"
                *ngIf="
                  registerForm.get('ToTime')?.touched &&
                  registerForm.get('ToTime')?.invalid
                "
              >
                ูุทููุจ
              </small>
            </div>

            <!-- Checkbox ูุฃูุงู ุงูุฃุณุจูุน -->
            <div class="col-12 mt-3">
              <label class="form-label d-block mb-2 fw-bold">ุงูุฃูุงู</label>
              <div class="d-flex flex-wrap gap-1">
                <div
                  *ngFor="let day of daysOfWeek; let i = index"
                  class="form-check form-check-inline d-flex align-items-center gap-1"
                >
                  <!-- โ ุงูู Checkbox ุงูุฃูู -->
                  <input
                    type="checkbox"
                    class="form-check-input"
                    [formControl]="dayControls[i]"
                    [id]="day"
                  />

                  <!-- ๐ท๏ธ ุงุณู ุงูููู ุจุนุฏู -->
                  <label class="form-check-label mb-0 me-4" [for]="day">
                    {{ day }}
                  </label>
                </div>
              </div>
              <small
                class="text-danger d-block mt-1"
                *ngIf="
                  registerForm.get('Days')?.touched &&
                  registerForm.get('Days')?.invalid
                "
              >
                ูุฌุจ ุงุฎุชูุงุฑ ููู ูุงุญุฏ ุนูู ุงูุฃูู
              </small>
            </div>

            <!-- ุฒุฑ ุงูุชุณุฌูู -->
            <div class="col-12 text-center mt-3">
              <button
                class="btn btn-warning btn-lg py-0"
                [disabled]="isSubmitting"
              >
                {{ isEditMode ? "๐ ุชุนุฏูู" : "โ ุชุณุฌูู" }}
              </button>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
